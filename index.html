<!DOCTYPE html>
<html>

<!-- External Scripts Loader onClick -->
<!-- This will prevents unnecessary page load time for the moduler website -->

<body>
    <button onClick="downloadPDF()">Download as PDF</button>
</body>

<script>
    function downloadPDF() {
        // Script loader function
        function loadScript(urls, callback) {
            urls.forEach(url => {
                // Adding the script tag to the head
                var head = document.head;
                var script = document.createElement('script');
                script.type = 'text/javascript';
                script.src = url;

                // Binding the event to the callback function
                script.onreadystatechange = callback;
                script.onload = callback;

                // Start loading
                head.appendChild(script);
            });
        }

        // Arbitrary function which will run after scripts loaded
        const pdfGenerate2D = function () {
            const mapDiv2d = $('.main-map');
            html2canvas(mapDiv2d, {
                useCORS: true,
                onrendered: function (canvas) {
                    var img = canvas.toDataURL("image/jpeg,1.0");
                    var pdf = new jsPDF({
                        orientation: 'landscape'
                    });
                    pdf.text(115, 15, 'SahaGozu 2D PDF Export')
                    pdf.addImage(img, 'JPEG', 2, 20, 293, 150);
                    pdf.save('a4.pdf')
                }
            });
        }

        // Initiate the process
        // loadScript(array,function)
        loadScript([
            'https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.2/jspdf.min.js',
            'https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.4.1/html2canvas.min.js'
        ], pdfGenerate2D);
    }
</script>

</html>